<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Wind</title>
    <style>
        html, body {
            overflow: hidden;
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }

        #canvas {
            width: 100%;
            height: 100%;
            touch-action: none;
        }
    </style>
    <script src="babylon.2.1.js"></script>
    <script src="Oimo.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", start, false);

        function start() {
            var canvas = document.getElementById("canvas");
            var engine = new BABYLON.Engine(canvas, true);

            BABYLON.SceneLoader.Load("", "test.babylon", engine, function (scene) {
                // Wait for textures and shaders to be ready
                scene.executeWhenReady(function () {
                    //console.log(scene);
                    scene.enablePhysics();
                    scene.collisionsEnabled = true;

                    var camera = scene.cameras[0];
                    camera.attachControl(canvas);

                    /*var pointLight = new BABYLON.PointLight("pointlight", new BABYLON.Vector3(0, 100000, 0), scene);
                    pointLight.diffuse = new BABYLON.Color3(1, .702, .208);
                    pointLight.specular = new BABYLON.Color3(.925, .576, 0);*/

                    /*var hemisphericLight = new BABYLON.HemisphericLight("hemisphericLight", new BABYLON.Vector3(0, 1, 0), scene);
                    hemisphericLight.diffuse = new BABYLON.Color3(.686, .835, .871);

                    //var camera = new BABYLON.ArcRotateCamera("ArcRotateCamera", 1.58, 1.265, 30, ground.position, scene);
                    var camera = new BABYLON.ArcRotateCamera("ArcRotateCamera", 1, 1.2, 15, BABYLON.Vector3(0, 0, 0), scene); //original alpha: 1.58 beta: 1.265
                    camera.keysUp = "38";
                    camera.keysDown = "40";
                    camera.keysLeft = "37";
                    camera.keysRight = "39";
                    camera.attachControl(canvas);
                    //camera.fov = 1.15;
                    //camera.minZ = .1;
                    //camera.maxZ = 100000;*/

                    //var camera = new BABYLON.FollowCamera("followCamera", ground.position, scene);
                    /*var camera = new BABYLON.FreeCamera("FreeCamera", new BABYLON.Vector3(0, 25000, 0), scene);
                    camera.speed = 500;
                    camera.minZ = .0001;
                    camera.maxZ = 10000;
                    camera.fov = 1.15;
                    camera.attachControl(canvas);
                    console.log(camera);*/

                    var background = new BABYLON.Layer("background", null, scene, true);
                    background.texture = new BABYLON.DynamicTexture("dynamicTexture", 512, scene, true);
                    var textureContext = background.texture.getContext();
                    var size = background.texture.getSize();

                    textureContext.clearRect(0, 0, size.width, size.height);

                    var gradient = textureContext.createLinearGradient(0, 0, 0, 512);
                    gradient.addColorStop(0, "#1e4877");
                    gradient.addColorStop(0.5, "#4584b4");

                    textureContext.fillStyle = gradient;
                    textureContext.fillRect(0, 0, 512, 512);
                    background.texture.update();

                    ///////////////////////////////////////////////////////////////////////////////
                    /*var cloudSpriteManager = new BABYLON.SpriteManager("cloudManager", "assets/cloud.png", 300, 3000, scene);
                    for (var i = 0; i < 300; i++) {
                        var cloud = new BABYLON.Sprite("cloud", cloudSpriteManager);
                        cloud.position.x = Math.random() * (6000 - -6000) + -6000; //Math.random() * (max - min) + min;
                        cloud.position.y = Math.random() * (15500 - 15000) + 15000;
                        cloud.position.z = Math.random() * (6000 - -6000) + -6000;
                        cloud.size = 3000;
                    }

                    console.log(cloudSpriteManager)*/


                    /////////////////////////////////////////////////////////////////////////////////

                    // Once the scene is loaded, just register a render loop to render it

                    engine.runRenderLoop(function () {
                        scene.render();
                    });

                    window.addEventListener("resize", function () {
                        engine.resize();
                    });
                });
            });
        }
    </script>
</head>
<body>
    <canvas id="canvas"></canvas>
</body>
</html>
